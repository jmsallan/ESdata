id_3 <- c("C_fi_bd", "C_fi_obs", "C_fi_AAPP", "C_fc_AAPP",  "FBCF", "VE_OV", "VE", "OV", "X_b", "X_s", "M_b", "M_s")
id_4 <- c("FBCF_afm", "FBCF_afi", "X_rm", "M_rm")
id_5 <- c("FBCF_afm_con", "FBCF_afm_maq", "FBCF_afm_rbc")
id_6 <- c("FBCF_afm_con_viv", "FBCF_afm_con_edif", "FBCF_afm_maq_transp", "FBCF_afm_maq_arm")
d1 <- data.frame(agr_label = id_1, agregado = demanda_1, nivel = 1)
d2 <- data.frame(agr_label = id_2, agregado = demanda_2, nivel = 2)
d3 <- data.frame(agr_label = id_3, agregado = demanda_3, nivel = 3)
d4 <- data.frame(agr_label = id_4, agregado = demanda_4, nivel = 4)
d5 <- data.frame(agr_label = id_5, agregado = demanda_5, nivel = 5)
d6 <- data.frame(agr_label = id_6, agregado = demanda_6, nivel = 6)
pib_demanda_agregados <- bind_rows(d1, d2, d3, d4, d5, d6)
save(pib_demanda_agregados, file = "data/pib_demanda_agregados.RData")
rentas_1 <- unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 1`)
rentas_2 <- unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 2`)
rentas_1 <- rentas_1[which(!is.na(rentas_1))]
rentas_2 <- rentas_2[which(!is.na(rentas_2))]
idr_1 <- c("pib", "rem", "rem_A", "rem_BE", "rem_C", "rem_F", "rem_GT", "rem_GI", "rem_J", "rem_K", "rem_L", "rem_MN", "rem_OQ", "rem_RT", "ben", "imp_sub")
idr_1[3]
idr_2 <- c("sal", "css", "sal_A", "css_A", "sal_BE", "css_BE", "sal_C", "css_C", "sal_F", "css_F", "sal_GT", "css_GT", "sal_GI", "css_GI", "sal_J", "css_J", "sal_K", "css_K", "sal_L", "css_L", "sal_MN", "css_MN", "sal_OQ", "css_OQ", "sal_RT", "css_RT", "imp", "sub")
r1 <- data.frame(agr_label = idr_1, agregado = rentas_1, nivel = 1)
r2 <- data.frame(agr_label = idr_2, agregado = rentas_2, nivel = 2)
pib_rentas_agregados <- bind_rows(r1, r2)
pib_rentas_agregados
save(pib_rentas_agregados, file = "data/pib_rentas_agregados.RData")
pib_dato <- data.frame(dato_label = c("base", "var_trim", "var_anual") , dato = unique(pib_pm_oferta$`Niveles y tasas`))
save(pib_dato, file = "~/Dropbox (UPC)/quanti_docs/02-RLab/00-packages/ESdata/data/pib_dato.RData")
save(pib_dato, file = "data/pib_dato.RData")
pib_tipo <- data.frame(tipo_label = c("no_ajustado", "ajustado"), tipo = unique(pib_pm_demanda$`Tipo de dato`))
save(pib_tipo, file = "data/pib_tipo.RData")
pib_pm_demanda <- pib_pm_demanda %>% mutate(dato2 = "valor")
pib_pm_demanda_indice <- pib_pm_demanda_indice %>% mutate(dato2 = "indice")
pib_pm_demanda <- bind_rows(pib_pm_demanda, pib_pm_demanda_indice)
pib_pm_demanda <- left_join(pib_pm_demanda, pib_dato, by =c("Niveles y tasas" = "dato"))
pib_pm_demanda <- left_join(pib_pm_demanda, pib_tipo,
by = c("Tipo de dato" = "tipo"))
pib_d1 <- pib_pm_demanda %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 1`)) %>%
left_join(pib_demanda_agregados, by = c("Agregados macroeconómicos: Nivel 1" = "agregado"))
pib_d2 <- pib_pm_demanda %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 2`)) %>%
left_join(pib_demanda_agregados, by = c("Agregados macroeconómicos: Nivel 2" = "agregado"))
pib_d3 <- pib_pm_demanda %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 3`)) %>%
left_join(pib_demanda_agregados, by = c("Agregados macroeconómicos: Nivel 3" = "agregado"))
pib_d4 <- pib_pm_demanda %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 4`)) %>%
left_join(pib_demanda_agregados, by = c("Agregados macroeconómicos: Nivel 4" = "agregado"))
pib_d5 <- pib_pm_demanda %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 5`)) %>%
left_join(pib_demanda_agregados, by = c("Agregados macroeconómicos: Nivel 5" = "agregado"))
pib_d6 <- pib_pm_demanda %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 6`)) %>%
left_join(pib_demanda_agregados, by = c("Agregados macroeconómicos: Nivel 6" = "agregado"))
pib_pm_demanda2 <- bind_rows(pib_d1, pib_d2, pib_d3, pib_d4, pib_d5, pib_d6)
pib_pm_demanda2 <- pib_pm_demanda2 %>%
select(-c(`Agregados macroeconómicos: Nivel 1`:`Agregados macroeconómicos: Nivel 6`)) %>%
rename(agregado = agr_label, ajuste = tipo_label, tipo = dato2, dato = dato_label, periodo = Periodo, valor = Total) %>%
select(-c(`Tipo de dato`, `Niveles y tasas`)) %>%
select(periodo, agregado, nivel, ajuste, tipo, dato, valor)
pib_pm_demanda2 <- ipc_dates(pib_pm_demanda2)
pib_pm_demanda2 <- pib_pm_demanda2 %>% filter(!is.na(valor))
pib_pm_demanda <- pib_pm_demanda2
save(pib_pm_demanda, file = "data/pib_pm_demanda.RData")
pib_pm_oferta <- pib_pm_oferta %>% mutate(dato2 = "valor")
pib_pm_oferta_indice <- pib_pm_oferta_indice %>% mutate(dato2 = "indice")
pib_pm_oferta <- bind_rows(pib_pm_oferta, pib_pm_oferta_indice)
pib_pm_oferta <- left_join(pib_pm_oferta, pib_dato, by =c("Niveles y tasas" = "dato"))
pib_pm_oferta <- left_join(pib_pm_oferta, pib_tipo,
by = c("Tipo de dato" = "tipo"))
pib_o1 <- pib_pm_oferta %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 1`)) %>%
left_join(pib_oferta_agregados, by = c("Agregados macroeconómicos: Nivel 1" = "agregado"))
pib_o2 <- pib_pm_oferta %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 2`)) %>%
left_join(pib_oferta_agregados, by = c("Agregados macroeconómicos: Nivel 2" = "agregado"))
pib_pm_oferta2 <- bind_rows(pib_o1, pib_o2)
pib_pm_oferta2 <- pib_pm_oferta2 %>%
select(-c(`Agregados macroeconómicos: Nivel 1`:`Agregados macroeconómicos: Nivel 2`)) %>%
rename(agregado = agr_label, ajuste = tipo_label, tipo = dato2, dato = dato_label, periodo = Periodo, valor = Total) %>%
select(-c(`Tipo de dato`, `Niveles y tasas`)) %>%
select(periodo, agregado, nivel, ajuste, tipo, dato, valor)
pib_pm_oferta2 <- ipc_dates(pib_pm_oferta2)
pib_pm_oferta2 <- pib_pm_oferta2 %>% filter(!is.na(valor))
pib_pm_oferta <- pib_pm_oferta2
pib_pm_oferta
save(pib_pm_oferta, file = "data/pib_pm_oferta.RData")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_dato, by =c("Niveles y tasas" = "dato"))
pib_pm_rentas <- left_join(pib_pm_rentas, pib_tipo,
by = c("Tipo de dato" = "tipo"))
pib_r1 <- pib_pm_rentas %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 1`)) %>%
left_join(pib_rentas_agregados, by = c("Agregados macroeconómicos: Nivel 1" = "agregado"))
pib_r2 <- pib_pm_rentas %>%
filter(!is.na(`Agregados macroeconómicos: Nivel 2`)) %>%
left_join(pib_rentas_agregados, by = c("Agregados macroeconómicos: Nivel 2" = "agregado"))
pib_pm_rentas2 <- bind_rows(pib_r1, pib_r2)
pib_pm_rentas2 <- pib_pm_rentas2 %>%
select(-c(`Agregados macroeconómicos: Nivel 1`:`Agregados macroeconómicos: Nivel 2`)) %>%
rename(agregado = agr_label, ajuste = tipo_label, dato = dato_label, periodo = Periodo, valor = Total) %>%
select(-c(`Tipo de dato`, `Niveles y tasas`)) %>%
select(periodo, agregado, nivel, ajuste, dato, valor)
pib_pm_rentas2 <- pib_pm_rentas2 %>% filter(!is.na(valor))
pib_pm_rentas2 <- ipc_dates(pib_pm_rentas2)
pib_pm_rentas <- pib_pm_rentas2
save(pib_pm_rentas, file = "data/pib_pm_rentas.RData")
library(tidyverse)
load("data/provincias_iso.RData")
read_pob <- function(code){
dir <- "https://www.ine.es/jaxi/files/_px/es/csv_bdsc/t20/e245/p08/l0/03002.csv_bdsc?nocab=1"
file <- read_csv2(dir, col_types = cols(Total=col_character()))
file <- file %>% mutate(Total=gsub("\\.", "", Total))
file <- file %>% mutate(Total=gsub(",", ".", Total))
file <- file %>% mutate(Total=as.numeric(Total))
return(file)
}
pob <- read_pob()
names(pob) <- c("region", "edad", "origen", "sexo", "periodo", "valor")
pob <- pob %>%
mutate(region = gsub("  ", " ", region))
pob <- left_join(pob, provincias_iso %>% select(label, iso), by = c("region" = "label") )
pob <- pob %>%
mutate(iso = replace_na(iso, "ES"))
unique(pob$iso)
pob <- pob %>%
mutate(sexo = recode(sexo, `Ambos sexos` = "total", Hombres = "hombres", Mujeres = "mujeres"))
load("data/defunciones_sexo_edad.RData")
edad_def <- c(unique(defunciones_sexo_edad$edad)[1:19], "90-94", "95-99", "100+")
edad_pob <- tibble(edad=unique(pob$edad), edad_label = edad_def)
edad_pob
pob <- left_join(pob, edad_pob, by = "edad")
unique(pob$edad_label)
pob %>% glimpse()
pob <- pob %>%
filter(origen == "TOTAL")
pob
pob_prov_edad <- pob %>%
select(periodo, iso, edad_label, sexo, valor) %>%
rename(region = iso, edad = edad_label)
pob_prov_edad
unique(pob_prov_edad$region)
save(pob_prov_edad, file = "data/pob_prov_edad.RData")
pob_ccaa <- read_epa("4925")
read_epa <- function(code){
dir <- paste0("https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/", code, ".csv?nocab=1")
file <- read_csv2(dir, col_types = cols(Total=col_character()))
file <- file %>% mutate(Total=gsub("\\.", "", Total))
file <- file %>% mutate(Total=gsub(",", ".", Total))
file <- file %>% mutate(Total=as.numeric(Total))
return(file)
}
pob_ccaa <- read_epa("4925")
names(pob_ccaa) <- c("sexo", "ccaa", "edad", "periodo", "valor")
unique(pob_ccaa$ccaa)
pob_ccaa <- left_join(pob_ccaa, ccaa_iso %>% select(label, iso),
by = c("ccaa" = "label"))
pob_ccaa <- pob_ccaa %>%
mutate(sexo = recode(sexo, `Ambos sexos` = "total", Hombres = "hombres", Mujeres = "mujeres"))
unique(pob_ccaa$sexo)
unique(pob_ccaa$edad)
unique(pob_ccaa$ccaa)
pob_ccaa <- left_join(pob_ccaa, edad_pob, by = "edad")
library(ESdata)
library(ESdata)
library(ESdata)
library(tidyverse)
pib_pm_rentas |>
glimpse()
t <- pib_pm_rentas %>%
filter(agregado %in% c("pib", "rem", "ben", "imp_sub") & dato == "base" & ajuste == "ajustado") %>%
select(periodo, agregado, valor)
t |>
group_by(periodo, agregado) |>
summarise(n = n(), .groups = "drop") |>
filter(n != 1)
t |>
group_by(periodo, agregado) |>
summarise(n = n(), .groups = "drop") |>
filter(n != 1) |>
pivot_wider(names_from = "agregado", values_from = "n")
t |>
group_by(periodo, agregado) |>
summarise(n = n(), .groups = "drop") |>
filter(n != 1) |>
pivot_wider(names_from = "agregado", values_from = "n") |>
print(n = 200)
pib_pm_rentas |>
filter(dato == "base" & ajuste == "ajustado")
pib_pm_rentas |>
filter(dato == "base" & ajuste == "ajustado") |>
group_by(periodo, agregado) |>
summarise(n = n(), .groups = "drop") |>
filter(n != 1) |>
pivot_wider(names_from = "agregado", values_from = "n") |>
print(n = 200)
pib_pm_rentas |>
filter(dato == "base" & ajuste == "ajustado") |>
group_by(periodo, agregado) |>
summarise(n = n(), .groups = "drop") |>
filter(n != 1) |>
pivot_wider(names_from = "agregado", values_from = "n") |>
glimpse()
pib_pm_rentas |>
filter(periodo == as.Date("1996-01-31"), dato == "base", ajuste == "ajustado")
library(tidyverse)
read_pib <- function(code){
dir <- paste0("https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/", code, ".csv?nocab=1")
file <- read_csv2(dir, col_types = cols(Total=col_character()))
file <- file %>% mutate(Total=gsub("\\.", "", Total))
file <- file %>% mutate(Total=gsub(",", ".", Total))
file <- file %>% mutate(Total=as.numeric(Total))
return(file)
}
ipc_dates <- function(table){
table <- table %>% mutate(periodo = gsub("M01", "-01-31", periodo))
table <- table %>% mutate(periodo = gsub("M02", "-02-28", periodo))
table <- table %>% mutate(periodo = gsub("M03", "-03-31", periodo))
table <- table %>% mutate(periodo = gsub("M04", "-04-30", periodo))
table <- table %>% mutate(periodo = gsub("M05", "-05-31", periodo))
table <- table %>% mutate(periodo = gsub("M06", "-06-30", periodo))
table <- table %>% mutate(periodo = gsub("M07", "-07-31", periodo))
table <- table %>% mutate(periodo = gsub("M08", "-08-31", periodo))
table <- table %>% mutate(periodo = gsub("M09", "-09-30", periodo))
table <- table %>% mutate(periodo = gsub("M10", "-10-31", periodo))
table <- table %>% mutate(periodo = gsub("M11", "-11-30", periodo))
table <- table %>% mutate(periodo = gsub("M12", "-12-31", periodo))
table <- table %>% mutate(periodo = gsub("T1", "-01-31", periodo))
table <- table %>% mutate(periodo = gsub("T2", "-06-30", periodo))
table <- table %>% mutate(periodo = gsub("T3", "-09-30", periodo))
table <- table %>% mutate(periodo = gsub("T4", "-12-31", periodo))
table <- table %>% mutate(periodo=as.Date(periodo))
}
pib_pm_oferta <- read_pib("30678")
pib_pm_demanda <- read_pib("30680")
pib_pm_rentas <- read_pib("30682")
pib_pm_oferta_indice <- read_pib("30679")
pib_pm_demanda_indice <- read_pib("30681")
rentas_1 <- unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 1`)
rentas_2 <- unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 2`)
rentas_1 <- rentas_1[which(!is.na(rentas_1))]
rentas_2 <- rentas_2[which(!is.na(rentas_2))]
idr_1 <- c("pib", "rem", "rem_A", "rem_BE", "rem_C", "rem_F", "rem_GT", "rem_GI", "rem_J", "rem_K", "rem_L", "rem_MN", "rem_OQ", "rem_RT", "ben", "imp_sub")
idr_1[3]
idr_2 <- c("sal", "css", "sal_A", "css_A", "sal_BE", "css_BE", "sal_C", "css_C", "sal_F", "css_F", "sal_GT", "css_GT", "sal_GI", "css_GI", "sal_J", "css_J", "sal_K", "css_K", "sal_L", "css_L", "sal_MN", "css_MN", "sal_OQ", "css_OQ", "sal_RT", "css_RT", "imp", "sub")
r1 <- data.frame(agr_label = idr_1, agregado = rentas_1, nivel = 1)
r2 <- data.frame(agr_label = idr_2, agregado = rentas_2, nivel = 2)
pib_rentas_agregados <- bind_rows(r1, r2)
pib_rentas_agregados
pib_rentas_agregados
pib_rentas_agregados |> glimpse()
pib_rentas_agregados
distinct(pib_rentas_agregados) |> glimpse()
save(pib_rentas_agregados, file = "data/pib_rentas_agregados.RData")
pib_dato <- data.frame(dato_label = c("base", "var_trim", "var_anual") , dato = unique(pib_pm_oferta$`Niveles y tasas`))
save(pib_dato, file = "data/pib_dato.RData")
pib_dato
save(pib_dato, file = "data/pib_dato.RData")
pib_tipo <- data.frame(tipo_label = c("no_ajustado", "ajustado"), tipo = unique(pib_pm_demanda$`Tipo de dato`))
pib_tipo
save(pib_tipo, file = "data/pib_tipo.RData")
pib_pm_rentas
pib_pm_rentas |> filter(is.na(`Agregados macroeconómicos: Nivel 1`) & is.na(`Agregados macroeconómicos: Nivel 2`))
pib_rentas_agregados
pib_rentas_agregados |>
glimpse()
pib_pm_rentas <- pib_pm_rentas |>
mutate(agregados = ifelse(is.na(`Agregados macroeconómicos: Nivel 1`), `Agregados macroeconómicos: Nivel 2`, `Agregados macroeconómicos: Nivel 1`)) |>
select(-c(`Agregados macroeconómicos: Nivel 1`, `Agregados macroeconómicos: Nivel 2`))
pib_pm_rentas |>
filter(is.na(agregados))
pib_pm_rentas
pib_pm_rentas <- left_join(pib_pm_rentas, pib_dato, by =c("Niveles y tasas" = "dato"))
pib_pm_rentas <- left_join(pib_pm_rentas, pib_tipo,
by = c("Tipo de dato" = "tipo"))
pib_pm_rentas <- left_join(pib_pm_rentas, pib_rentas_agregados,
by = c("agregados" = "agregado"))
pib_pm_rentas |>
filter(is.na(dato))
pib_pm_rentas |>
filter(is.na(dato_label))
unique(pib_pm_rentas$dato_label)
pib_tipi
pib_tipo
pib_pm_rentas |>
filter(is.na(tipo_label))
pib_pm_rentas |>
filter(is.na(agr_label))
pib_pm_rentas <- pib_pm_rentas %>%
rename(agregado = agr_label, ajuste = tipo_label, dato = dato_label, periodo = Periodo, valor = Total) %>%
select(periodo, agregado, nivel, ajuste, dato, valor)
pib_pm_rentas
pib_pm_rentas2 %>% filter(!is.na(valor))
pib_pm_rentas %>% filter(!is.na(valor))
pib_pm_rentas2 <- pib_pm_rentas %>% filter(!is.na(valor))
pib_pm_rentas <- pib_pm_rentas %>% filter(!is.na(valor))
pib_pm_rentas <- ipc_dates(pib_pm_rentas)
save(pib_pm_rentas, file = "data/pib_pm_rentas.RData")
pib_pm_rentas %>%
filter(agregado %in% c("pib", "rem", "ben", "imp_sub") & dato == "base" & ajuste == "ajustado") %>%
pivot_wider(names_from = "agregado", values_from = "valor") %>%
mutate(pr_rem = rem/pib, pr_ben = ben/pib, pr_imp = imp_sub/pib) %>%
select(periodo, pr_rem, pr_ben, pr_imp) %>%
pivot_longer(cols = -periodo, names_to = "dato", values_to = "valor")
library(ESdata)
library(ESdata)
library(tidyverse)
pib_pm_rentas |>
glimpse()
pib_pm_rentas |>
filter(periodo == as.Date("1996-01-31"), dato == "base", ajuste == "ajustado")
library(ESdata)
pib_pm_rentas |> filter(nivel == 1)
pib_pm_rentas |> filter(nivel == 1)
library(ESdata)
pib_pm_rentas |>
glimpse()
library(tidyverse)
pib_pm_rentas |>
glimpse()
pib_pm_rentas |>
filter(nivel == 2)
library(ESdata)
library(tidyverse)
library(ESdata)
read_pib <- function(code){
dir <- paste0("https://www.ine.es/jaxiT3/files/t/es/csv_bdsc/", code, ".csv?nocab=1")
file <- read_csv2(dir, col_types = cols(Total=col_character()))
file <- file %>% mutate(Total=gsub("\\.", "", Total))
file <- file %>% mutate(Total=gsub(",", ".", Total))
file <- file %>% mutate(Total=as.numeric(Total))
return(file)
}
ipc_dates <- function(table){
table <- table %>% mutate(periodo = gsub("M01", "-01-31", periodo))
table <- table %>% mutate(periodo = gsub("M02", "-02-28", periodo))
table <- table %>% mutate(periodo = gsub("M03", "-03-31", periodo))
table <- table %>% mutate(periodo = gsub("M04", "-04-30", periodo))
table <- table %>% mutate(periodo = gsub("M05", "-05-31", periodo))
table <- table %>% mutate(periodo = gsub("M06", "-06-30", periodo))
table <- table %>% mutate(periodo = gsub("M07", "-07-31", periodo))
table <- table %>% mutate(periodo = gsub("M08", "-08-31", periodo))
table <- table %>% mutate(periodo = gsub("M09", "-09-30", periodo))
table <- table %>% mutate(periodo = gsub("M10", "-10-31", periodo))
table <- table %>% mutate(periodo = gsub("M11", "-11-30", periodo))
table <- table %>% mutate(periodo = gsub("M12", "-12-31", periodo))
table <- table %>% mutate(periodo = gsub("T1", "-01-31", periodo))
table <- table %>% mutate(periodo = gsub("T2", "-06-30", periodo))
table <- table %>% mutate(periodo = gsub("T3", "-09-30", periodo))
table <- table %>% mutate(periodo = gsub("T4", "-12-31", periodo))
table <- table %>% mutate(periodo=as.Date(periodo))
}
pib_pm_oferta <- read_pib("30678")
pib_pm_demanda <- read_pib("30680")
pib_pm_rentas <- read_pib("30682")
pib_pm_oferta_indice <- read_pib("30679")
pib_pm_demanda_indice <- read_pib("30681")
rentas_1 <- unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 1`)
rentas_2 <- unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 2`)
rentas_1 <- rentas_1[which(!is.na(rentas_1))]
rentas_2 <- rentas_2[which(!is.na(rentas_2))]
idr_1 <- c("pib", "rem", "rem_A", "rem_BE", "rem_C", "rem_F", "rem_GT", "rem_GI", "rem_J", "rem_K", "rem_L", "rem_MN", "rem_OQ", "rem_RT", "ben", "imp_sub")
idr_1[3]
idr_2 <- c("sal", "css", "sal_A", "css_A", "sal_BE", "css_BE", "sal_C", "css_C", "sal_F", "css_F", "sal_GT", "css_GT", "sal_GI", "css_GI", "sal_J", "css_J", "sal_K", "css_K", "sal_L", "css_L", "sal_MN", "css_MN", "sal_OQ", "css_OQ", "sal_RT", "css_RT", "imp", "sub")
r1 <- data.frame(agr_label = idr_1, agregado = rentas_1, nivel = 1)
r2 <- data.frame(agr_label = idr_2, agregado = rentas_2, nivel = 2)
pib_rentas_agregados <- bind_rows(r1, r2)
pib_rentas_agregados
unique(pib_pm_rentas$`Tipo de dato`)
pib_pm_rentas |>
filter(Periodo == "2022T3", `Tipo de dato` == "Datos ajustados de estacionalidad y calendario", `Niveles y tasas` == "Dato base")
pib_pm_rentas$`Agregados macroeconómicos: Nivel 1`
unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 1`)
pib_pm_rentas |>
filter(Periodo == "2022T3", `Tipo de dato` == "Datos ajustados de estacionalidad y calendario", `Niveles y tasas` == "Dato base", `Agregados macroeconómicos: Nivel 1` = "Producto interior bruto a precios de mercado")
pib_pm_rentas |>
filter(Periodo == "2022T3", `Tipo de dato` == "Datos ajustados de estacionalidad y calendario", `Niveles y tasas` == "Dato base", `Agregados macroeconómicos: Nivel 1` == "Producto interior bruto a precios de mercado")
pib_pm_rentas |>
filter(Periodo == "2022T3", `Tipo de dato` == "Datos ajustados de estacionalidad y calendario", `Niveles y tasas` == "Dato base", `Agregados macroeconómicos: Nivel 1` == "Producto interior bruto a precios de mercado")
pib_pm_rentas <- pib_pm_rentas |>
mutate(agregados = ifelse(is.na(`Agregados macroeconómicos: Nivel 1`), `Agregados macroeconómicos: Nivel 2`, `Agregados macroeconómicos: Nivel 1`)) |>
select(-c(`Agregados macroeconómicos: Nivel 1`, `Agregados macroeconómicos: Nivel 2`))
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
`Niveles y tasas` == "Dato base",
agregados == "Producto interior bruto a precios de mercado")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_dato,
by =c("Niveles y tasas" = "dato"))
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
`Niveles y tasas` == "Dato base",
agregados == "Producto interior bruto a precios de mercado")
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
dato_label == "base",
agregados == "Producto interior bruto a precios de mercado")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_tipo,
by = c("Tipo de dato" = "tipo"))
pib_pm_rentas |>
filter(Periodo == "2022T3",
tipo_label == "ajustado",
dato_label == "base",
agregados == "Producto interior bruto a precios de mercado")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_rentas_agregados,
by = c("agregados" = "agregado"))
pib_pm_rentas |>
filter(Periodo == "2022T3",
tipo_label == "ajustado",
dato_label == "base",
agr_label == "pib")
pib_pm_rentas <- pib_pm_rentas %>%
rename(agregado = agr_label, ajuste = tipo_label, dato = dato_label, periodo = Periodo, valor = Total) %>%
select(periodo, agregado, nivel, ajuste, dato, valor)
pib_pm_rentas |>
filter(periodo == "2022T3",
ajuste == "ajustado",
dato == "base",
agregado == "pib")
pib_pm_rentas <- pib_pm_rentas %>% filter(!is.na(valor))
pib_pm_rentas |>
filter(periodo == as.Date("2022-09-30"),
ajuste == "ajustado",
dato == "base",
agregado == "pib")
as.Date("2022-09-30")
pib_pm_rentas |>
filter(periodo == "2022T3",
ajuste == "ajustado",
dato == "base",
agregado == "pib")
pib_pm_rentas |>
filter(periodo == as.Date("2022-09-30"),
ajuste == "ajustado",
dato == "base",
agregado == "pib")
unique(pib_pm_rentas$periodo)
pib_pm_rentas <- ipc_dates(pib_pm_rentas)
pib_pm_rentas |>
filter(periodo == as.Date("2022-09-30"),
ajuste == "ajustado",
dato == "base",
agregado == "pib")
pib_pm_rentas |>
filter(periodo == as.Date("1996-01-31"), dato == "base", ajuste == "ajustado")
pib_pm_rentas <- read_pib("30682")
unique(pib_pm_rentas$`Agregados macroeconómicos: Nivel 2`)
pib_rentas_agregados
pib_rentas_agregados |> filter(agr_label == "rem")
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
`Niveles y tasas` == "Dato base",
`Agregados macroeconómicos: Nivel 1` == "Remuneración de los asalariados")
pib_pm_rentas <- pib_pm_rentas |>
mutate(agregados = ifelse(is.na(`Agregados macroeconómicos: Nivel 2`), `Agregados macroeconómicos: Nivel 1`, `Agregados macroeconómicos: Nivel 2`)) |>
select(-c(`Agregados macroeconómicos: Nivel 1`, `Agregados macroeconómicos: Nivel 2`))
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
`Niveles y tasas` == "Dato base",
`Agregados macroeconómicos: Nivel 2` == "Remuneración de los asalariados")
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
`Niveles y tasas` == "Dato base",
agregados == "Remuneración de los asalariados")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_dato,
by =c("Niveles y tasas" = "dato"))
pib_pm_rentas |>
filter(Periodo == "2022T3",
`Tipo de dato` == "Datos ajustados de estacionalidad y calendario",
dato_label == "base",
agregados == "Remuneración de los asalariados")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_tipo,
by = c("Tipo de dato" = "tipo"))
pib_pm_rentas |>
filter(Periodo == "2022T3",
tipo_label == "ajustado",
dato_label == "base",
agregados == "Remuneración de los asalariados")
pib_pm_rentas <- left_join(pib_pm_rentas, pib_rentas_agregados,
by = c("agregados" = "agregado"))
pib_pm_rentas |>
filter(Periodo == "2022T3",
tipo_label == "ajustado",
dato_label == "base",
agr_label == "rem")
pib_pm_rentas <- pib_pm_rentas %>%
rename(agregado = agr_label, ajuste = tipo_label, dato = dato_label, periodo = Periodo, valor = Total) %>%
select(periodo, agregado, nivel, ajuste, dato, valor)
pib_pm_rentas <- pib_pm_rentas %>% filter(!is.na(valor))
pib_pm_rentas |>
filter(periodo == "2022T3",
ajuste == "ajustado",
dato == "base",
agregado == "rem")
pib_pm_rentas <- ipc_dates(pib_pm_rentas)
pib_pm_rentas |>
filter(periodo == as.Date("2022-09-30"),
ajuste == "ajustado",
dato == "base",
agregado == "rem")
save(pib_pm_rentas, file = "data/pib_pm_rentas.RData")
t <- pib_pm_rentas %>%
filter(agregado %in% c("pib", "rem", "ben", "imp_sub") & dato == "base" & ajuste == "ajustado") %>%
select(periodo, agregado, valor)
t <- pib_pm_rentas %>%
filter(agregado %in% c("pib", "rem", "ben", "imp_sub") & dato == "base" & ajuste == "ajustado") %>%
pivot_wider(names_from = "agregado", values_from = "valor")
t
library(ESdata)
